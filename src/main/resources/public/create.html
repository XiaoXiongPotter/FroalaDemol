<!DOCTYPE html>
<html lang="en" data-layout-decorate="~{layouts/default-layout}">
  <head id="head" data-z="user-managed">
    <!-- default header name is X-CSRF-TOKEN  
     <meta name="_csrf" data-th-content="${_csrf.token}" />
     <meta name="_csrf_header" data-th-content="${_csrf.headerName}" />
      -->
    <link rel="stylesheet" type="text/css" href="bootstrap-fileinput-master/css/fileinput.css" data-th-href="@{/public/css/fileinput.min.css}" />
      <!-- wysiwyg-editor-->
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/froala_editor.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/froala_style.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/froala_editor.pkgd.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/code_view.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/colors.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/emoticons.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/image_manager.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/image.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/line_breaker.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/table.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/char_counter.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/video.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/fullscreen.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/file.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/quick_insert.css}" />
    <link rel="stylesheet" type="text/css" href="http://wysihtml.com" data-th-href="@{/public/wysiwyg_editor/css/plugins/special_characters.min.css}" />
  
    <title data-th-text="#{label_create_entity(#{label_article})}">
      Create Article - pla - SpringRoo Application</title>

   
  </head>

    <body id="body" data-z="user-managed">

    <header role="banner">

      <!-- Content replaced by layout of the page displayed -->
    </header>

    <!-- CONTAINER -->
    <div class="container bg-container">
      <!-- CONTENT -->
      <!--
        Only the inner content of the following tag "section" is included
        within the template, in the section "content"
      -->
      <section data-layout-fragment="content">
        <div class="container-fluid content" data-th-with="collectionLink=${@linkBuilder.of('ArticlesCollectionThymeleafController')}">

          <h1 data-th-text="#{label_create_entity(#{label_article})}">Create Article</h1>

          <!-- FORM -->
          <form class="form-horizontal validate" method="POST" data-th-object="${article}" data-th-action="@{${collectionLink.to('create2').with('article', article.id)}}" enctype="multipart/form-data">

            <fieldset id="containerFields">
              <legend class="sr-only" data-th-text="#{label_data_entity(#{label_article})}">Article data </legend>

<div class="form-group has-error has-feedback" data-z="user-managed" id="article-type-field" data-th-classappend="${#fields.hasErrors('type')}? 'has-error has-feedback'" data-th-class="form-group">
    <label for="type" class="col-md-3 control-label" data-th-text="#{label_article_type}">type</label>
    <div class="col-md-6">
      <!-- Select2 -->
      <select data-th-field="*{type}" class="form-control dropdown-select-simple" data-allow-clear="true" data-th-attr="data-placeholder=#{info_select_an_option}" required="required">
         <option data-th-each="item : ${type}" data-th-value="${item}" data-th-text="${{item}}">Value</option>
      </select>
      <span data-th-classappend="${#fields.hasErrors('type')}? 'glyphicon glyphicon-remove form-control-feedback'" class="glyphicon glyphicon-remove form-control-feedback" data-th-if="${#fields.hasErrors('type')}" aria-hidden="true"></span>
      <span id="type-error" class="help-block" data-th-if="${#fields.hasErrors('type')}" data-th-errors="*{type}">Error message.</span>
    </div>
</div>
<div class="form-group has-error has-feedback" data-z="user-managed" id="article-sort-field" data-th-classappend="${#fields.hasErrors('sort')}? 'has-error has-feedback'" data-th-class="form-group">
    <label for="sort" class="col-md-3 control-label" data-th-text="#{label_article_sort}">sort</label>
    <div class="col-md-6">
      <!-- Select2 -->
      <select data-th-field="*{sort}" class="form-control dropdown-select-simple" data-allow-clear="true" data-th-attr="data-placeholder=#{info_select_an_option}">
         <option data-th-each="item : ${sort}" data-th-value="${item}" data-th-text="${{item}}">Value</option>
      </select>
      <span data-th-classappend="${#fields.hasErrors('sort')}? 'glyphicon glyphicon-remove form-control-feedback'" class="glyphicon glyphicon-remove form-control-feedback" data-th-if="${#fields.hasErrors('sort')}" aria-hidden="true"></span>
      <span id="sort-error" class="help-block" data-th-if="${#fields.hasErrors('sort')}" data-th-errors="*{sort}">Error message.</span>
    </div>
</div>

<div class="form-group has-error has-feedback" data-z="b4e90173" id="article-title-field" data-th-classappend="${#fields.hasErrors('title')}? 'has-error has-feedback'" data-th-class="form-group">
  <label for="title" class="col-md-3 control-label" data-th-text="#{label_article_title}">title</label>
  <div class="col-md-6">
    <input id="title" name="title" data-th-value="*{{title}}" type="text" class="form-control" placeholder="title" data-th-placeholder="#{label_article_title}" data-toggle="tooltip" aria-describedby="titleStatus" required="required" />
      <span data-th-classappend="${#fields.hasErrors('title')}? 'glyphicon glyphicon-remove form-control-feedback'" class="glyphicon glyphicon-remove form-control-feedback" data-th-if="${#fields.hasErrors('title')}" aria-hidden="true"></span>
      <span id="title-error" class="help-block" data-th-if="${#fields.hasErrors('title')}" data-th-errors="*{title}">Error message.</span>
  </div>
</div>
<div class="form-group has-error has-feedback" data-z="user-managed" id="article-filepath-field" data-th-classappend="${#fields.hasErrors('filePath')}? 'has-error has-feedback'" data-th-class="form-group">
  <label for="filePath" class="col-md-3 control-label" data-th-text="#{label_article_filepath}">filePath</label>
  <div class="col-md-6">
<input type="file" name="pdfFile" id="pdfFile" data-th-multiple="true" class="file-loading" />
  <label id="uploadFile"></label>
  </div>
  <div class="col-md-6" hidden="true">
      <input id="filePath" name="filePath" data-th-value="*{{filePath}}" type="text" class="form-control" placeholder="filePath" data-th-placeholder="#{label_article_filepath}" data-toggle="tooltip" aria-describedby="filePathStatus" data-show-caption="true" />
      <span data-th-classappend="${#fields.hasErrors('filePath')}? 'glyphicon glyphicon-remove form-control-feedback'" class="glyphicon glyphicon-remove form-control-feedback" data-th-if="${#fields.hasErrors('filePath')}" aria-hidden="true"></span>
      <span id="filePath-error" class="help-block" data-th-if="${#fields.hasErrors('filePath')}" data-th-errors="*{filePath}">Error message.</span>
  </div>
</div>
<div class="form-group has-error has-feedback" data-z="user-managed" id="article-content-field" data-th-classappend="${#fields.hasErrors('content')}? 'has-error has-feedback'" data-th-class="form-group">
  <label for="content" class="col-md-3 control-label" data-th-text="#{label_article_content}">content</label>
  <div class="col-md-8">
   
      <span data-th-classappend="${#fields.hasErrors('content')}? 'glyphicon glyphicon-remove form-control-feedback'" class="glyphicon glyphicon-remove form-control-feedback" data-th-if="${#fields.hasErrors('content')}" aria-hidden="true"></span>
      <span id="content-error" class="help-block" data-th-if="${#fields.hasErrors('content')}" data-th-errors="*{content}">Error message.</span>
      <textarea id="content" name="content" data-th-value="*{{content}}" class="form-control" placeholder="content" data-th-placeholder="#{label_article_content}" data-toggle="tooltip" aria-describedby="contentStatus"></textarea>
 
  </div>
  
</div>
   
                      <div class="form-group has-error has-feedback" data-z="user-managed" id="article-publishdate-field" data-th-classappend="${#fields.hasErrors('publishDate')}? 'has-error has-feedback'" data-th-class="form-group" hidden="true">
  <label for="publishDate" class="col-md-3 control-label" data-th-text="#{label_article_publishdate}">publishDate</label>
  <div class="col-md-6">
    <input id="publishDate" name="publishDate" data-th-value="*{{publishDate}}" type="text" class="form-control" placeholder="publishDate" data-th-placeholder="#{label_article_publishdate}" data-toggle="tooltip" aria-describedby="publishDateStatus" />
      <span data-th-classappend="${#fields.hasErrors('publishDate')}? 'glyphicon glyphicon-remove form-control-feedback'" class="glyphicon glyphicon-remove form-control-feedback" data-th-if="${#fields.hasErrors('publishDate')}" aria-hidden="true"></span>
      <span id="publishDate-error" class="help-block" data-th-if="${#fields.hasErrors('publishDate')}" data-th-errors="*{publishDate}">Error message.</span>
  </div>
</div>



                      <div class="form-group has-error has-feedback" data-z="user-managed" id="article-author-field" data-th-classappend="${#fields.hasErrors('author')}? 'has-error has-feedback'" data-th-class="form-group" data-th-with="collectionLink=${@linkBuilder.of('StaffsCollectionThymeleafController')}" hidden="true">
    <label for="author" class="col-md-3 control-label" data-th-text="#{label_article_author}">Staff</label>
    <div class="col-md-6">
      <!-- Select2 -->
      <select data-th-field="*{author}" class="form-control dropdown-select-ajax" data-allow-clear="true" data-data-ajax--url="${collectionLink.to('select2')}" data-ajax--cache="true" data-ajax--delay="250" data-ajax--data-type="json" data-data-placeholder="#{info_select_an_option}">
          <option data-th-unless="*{author} == null" data-th-value="*{author.id}" data-th-text="*{{author}}" selected="selected">Staff</option>
      </select>
      <span data-th-classappend="${#fields.hasErrors('author')}? 'glyphicon glyphicon-remove form-control-feedback'" class="glyphicon glyphicon-remove form-control-feedback" data-th-if="${#fields.hasErrors('author')}" aria-hidden="true"></span>
      <span id="author-error" class="help-block" data-th-if="${#fields.hasErrors('author')}" data-th-errors="*{author}">Error message.</span>
    </div>
</div>
            </fieldset>
              <!-- buttons form -->
              <div class="form-group">
                <div class="col-md-9 col-md-offset-3" style="margin: 0px 0px 0px -5%;">
                    <button type="submit" class="btn btn-primary" data-th-text="#{label_save}">Save</button>
                    <button type="reset" class="btn btn-default" onclick="location.href='list.html'" data-th-onclick="'location.href=\'' + @{${collectionLink.to('list')}} + '\''" data-th-text="#{label_reset}">Cancel</button>
                </div>
              </div>

          </form>
          <!-- /FORM -->

        </div>
      </section>
      <!-- /CONTENT -->
  </div>
  <!-- /CONTAINER -->

  <footer class="container">
    <!-- Content replaced by layout of the page displayed -->
  </footer>

  <!-- JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so that the pages load faster -->
  <!-- JavaScript loaded by layout of the page displayed -->
  <!--
       Only the inner content of the following tag "javascript" is included
       within the template, in the div "javascript"
      -->
  <div data-layout-fragment="javascript">
    <div data-th-replace="~{fragments/editor-js::js}"> </div>
    <!-- DateTimePicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.4/build/jquery.datetimepicker.full.min.js" data-th-src="@{/webjars/datetimepicker/build/jquery.datetimepicker.full.min.js}"></script>
    <script src="../../static/public/js/datetimepicker-defaults.js" data-th-src="@{/public/js/datetimepicker-defaults.js}"></script>

    <!-- jquery.inputmask -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.1/jquery.inputmask.bundle.min.js" data-th-src="@{/webjars/jquery.inputmask/min/jquery.inputmask.bundle.min.js}"></script>
    <script type="text/javascript" data-th-inline="javascript">
					(function(jQuery) {
						jQuery(document)
								.ready(
										function() {
											Inputmask
													.extendAliases({
														'numeric' : {
															'groupSeparator' : /*[[#{label_inputmask_groupSeparator}]]*/'.',
															'radixPoint' : /*[[#{label_inputmask_radixPoint}]]*/','
														},
														'currency' : {
															'prefix' : /*[[#{label_inputmask_prefix}]]*/'',
															'suffix' : /*[[#{label_inputmask_suffix}]]*/' 
														}
													});
										});
					})(jQuery);
  		</script>
    <script src="../../static/public/js/inputmask-defaults.js" data-th-src="@{/public/js/inputmask-defaults.js}"></script>

    <!-- JQuery Validation -->
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.0/jquery.validate.min.js" data-th-src="@{/webjars/jquery-validation/dist/jquery.validate.min.js}">
		  </script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.0/additional-methods.min.js" data-th-src="@{/webjars/jquery-validation/dist/additional-methods.min.js}">
			</script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.0/localization/messages_es.js" data-th-src="@{/webjars/jquery-validation/src/localization/messages_}+${#locale.language}+'.js'" data-th-if="${#locale.language} != 'en'">
			</script>
    <script src="../../static/public/js/validation-defaults.js" data-th-src="@{/public/js/validation-defaults.js}">
			</script>

    <script type="text/javascript" data-th-inline="javascript">
					(function(jQuery) {
						jQuery(document)
								.ready(
									
										function() {
											jQuery
													.extend(
															jQuery.validator.messages,
															{
																'dateformat' : /*[[#{error_invalid_date}]]*/'Please enter a correct date/time',
																'inputmask' : /*[[#{error_invalid_maskValue}]]*/'Please enter a valid value',
															});
										}
										
								);
						               
					})(jQuery);
		  </script>
		  
		  
   <script>
         $(function(){
		            /*
				    var token = $("meta[name='_csrf']").attr("content");
					var header = $("meta[name='_csrf_header']").attr("content");
					$(document).ajaxSend(function(e, xhr, options) {
						xhr.setRequestHeader(header, token);
					});
					*/
					$('#content')
							.froalaEditor(
									{
										inlineMode : false,
										alwaysBlank : true,
										direction : "ltr",
										allowedImageTypes : [ "jpeg", "jpg",
												"png", "gif" ],
										autosave : true,
										//autosaveInterval: 5000,
										//         saveURL: '/articles/upload',
										//         saveParams: { postId: "123" },
										spellcheck : true,
										plainPaste : true,
										imageButtons : [ "floatImageLeft",
												"floatImageNone",
												"floatImageRight", "linkImage",
												"replaceImage", "removeImage" ],
										imageUploadURL : '/articles/upload',
										imageUploadMethod: 'POST',
										//         imageParams: { postId: "123" },
										         enableScript: false,
										//imageUploadParam : 'file',
										language : 'zh_cn',
										tableResizerOffset : 5,
										tableResizingLimit : 100,
										paragraphFormatSelection: true,
										fontFamilySelection: true,
							            fontSizeSelection: true,
										toolbarButtons : [ 'bold', 'italic',
												'underline', 'strikeThrough',
												'paragraphFormat', 'align',
												'color', 'fontSize','fontFamily',
												'insertTable', 'insertImage',
												'undo', 'redo', 'formatOL',
												'formatUL', 'outdent',
												'indent', 'clearFormatting',
												'fullscreen' ],
										//		imageUploadURL: '/upload',

										//     fileUploadURL: 'http://localhost:8080/upload',
										//     fileUploadParams: {
										//      id: 'my_editor'
										//    },
										imageManagerLoadURL : '/load_images',
										imageManagerDeleteURL : "/delete_image",
										imageManagerDeleteMethod : "POST",
										imageErrorCallback : function(data) {
											//	console.log(data);
										}

									})
							// Catch image removal from the editor.
							.on(
									'froalaEditor.image.removed',
									function(e, editor, $img) {
										$
												.ajax({
													// Request method.
													method : "POST",
													// Request URL.
													url : "/delete_image",
													// Request params.
													data : {
														src : $img.attr('src')
													}
												})
												.done(
														function(data) {
															console
																	.log('image was deleted');
														})
												.fail(
														function(err) {
															console
																	.log('image delete problem: '
																			+ JSON
																					.stringify(err));
														})
									})
							// Catch image removal from the editor.
							.on(
									'froalaEditor.file.unlink',
									function(e, editor, link) {
										$
												.ajax(
														{
															// Request method.
															method : "POST",
															// Request URL.
															url : "/delete_file",
															// Request params.
															data : {
																src : link
																		.getAttribute('href')
															}
														})
												.done(
														function(data) {
															console
																	.log('file was deleted');
														})
												.fail(
														function(err) {
															console
																	.log('file delete problem: '
																			+ JSON
																					.stringify(err));
														})
									})
				});
			</script>
		<script type="text/javascript">
			$(function() {
				initFileInput("pdfFile");
			})
            function initFileInput(ctrlName) {
		    var control = $('#' + ctrlName);
		    control.fileinput({
		        language: 'zh',
		       // uploadUrl: 'http://i.froala.com/upload',
		        uploadUrl: '/articles/uploadFile',
		        uploadAsync: false,
		        showPreview : true,
		        allowedFileExtensions:['PDF','pdf','zip','ZIP','rar','RAR'],
		        showUpload: false,
		        showCaption: false,
		        browseClass: "btn btn-primary",
		        maxFileCount: 1,
		        enctype: 'multipart/form-data',
		        validateInitialCount:true
		    })
		  .on("fileuploaded", function(event, data) {  
			 // alert("data:"+data.response)
            //  $("#uploadFile").text(data.response);
		      $("#filePath").attr("value",data.response);  
		  });
		}

		</script>
		
		<script type="text/javascript"> 
	/*	
		$.ajax({
			         type:"GET", 
			         url:"/upload", 
			         dataType:"json",      
			         contentType:"application/json", 
			         success:function(data){
			             console.log(data);
			         }
			    });
		*/
    </script>
		
	</div>

  </body>

</html>